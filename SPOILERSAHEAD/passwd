#!/bin/bash

#hmm i wonder where this leads...
LOGFILE="/var/log/changes.log"

# Ensure script is run as root
if [[ $EUID -ne 0 ]]; then
   echo "This script must be run as root" 1>&2
   exit 1
fi

# Get the username to change the password for
echo -n "Enter username: "
read username

# Check if the user exists
if ! id "$username" &>/dev/null; then
    echo "User $username does not exist."
    exit 1
fi

# Use the passwd command to change the password
echo "Changing password for user $username."
echo -e "Please enter new password:"
passwd_output=$(passwd "$username" 2>&1)

# Check if the password change was successful
if [[ $? -eq 0 ]]; then
    echo "$(date): Password for user $username changed." >> "$LOGFILE"
    echo "Password successfully changed."
else
    echo "$(date): Failed to change password for user $username." >> "$LOGFILE"
    echo "Password change failed: $passwd_output"
    exit 1
fi
